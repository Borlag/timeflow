# TimeFlow Patch #4 — Проекты в табеле, согласование задач, участники проекта, фиксы UI

## Что нового
1) **Списание часов "на проект"** без конкретной задачи. Для этого в `TimeEntry` добавлен столбец `project_id` (nullable).
2) **Участники проекта (ProjectMember)** — кто может списывать часы в проект.
3) **Согласование задач**, созданных не менеджером/админом: новые задачи от сотрудника имеют `approved=False` и видны как «на согласовании» до одобрения.
4) **Страница проекта** `/projects/{id}` — список задач проекта, управление участниками, быстрые действия.
5) **Фикс кнопки "бургер"** — теперь сворачивание меню работает корректно (z-index).
6) **Табель**: выбор проекта ИЛИ задачи; если выбрано и то и другое — берётся задача.

## Как применить
1. **models.py** — заменить/обновить классы `TimeEntry` (добавить `project_id` и `project`), `Project`, `User`, и добавить новый класс `ProjectMember`.  
   См. файл `models_snippet.patch.txt` и внесите изменения.
2. **app.py** — вставить/заменить обработчики:
   - `/timesheet` (чтобы передавать список разрешённых проектов пользователю),
   - `/timesheet/add` (принимает `project_id` и умеет логировать на проект),
   - новые маршруты `/projects/{project_id}` (детали), `/projects/{project_id}/members/add`, `/projects/{project_id}/members/remove`,
   - в **Согласованиях** добавить обработку задач `/admin/approve_task`,
   - стартовая миграция (в `startup()` или рядом) — добавить столбец `project_id` в `time_entries`, если его ещё нет.
   См. `app_snippet.patch.txt`.
3. **templates/** — скопировать файлы из архива:
   - `templates/timesheet.html` (появился выбор проекта),
   - `templates/projects.html` (добавлены ссылки в проект и колонка «Дата создания» уже была),
   - `templates/project_detail.html` (НОВЫЙ),
   - `templates/tasks.html` (показывает статус согласования),
   - `templates/admin.html` (добавлена секция задач на согласовании).
4. **static/theme.css** — заменить на версию из архива (фикс z-index: `.topbar` теперь выше сайдбара).

5. Перезапустить `uvicorn`. При первом старте миграция добавит `project_id` в таблицу `time_entries`.

## Примечания
- Правило: в табеле можно выбрать **либо задачу, либо проект**. Если выбрано оба — используется задача (и её проект).
- Выбор проектов в табеле для сотрудника ограничен: **владелец проекта**, **участник проекта**, либо роль `manager/admin` — видят активные проекты. Добавляйте участников на странице проекта.
- Метрики **учитывают** проектные часы, даже если они списаны «на проект» (без задачи).
